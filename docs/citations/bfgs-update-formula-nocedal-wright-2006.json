{
  "reference": "nocedal-wright-2006",
  "pages": "140",
  "theorem": "Equation (6.19)",
  "claim": "The BFGS method updates the Hessian approximation $B_k$ using a rank-two formula: $B_{k+1} = B_k - \\frac{B_k s_k s_k^T B_k}{s_k^T B_k s_k} + \\frac{y_k y_k^T}{y_k^T s_k}$",
  "quote": "The update formula for $B_k$ is obtained by simply applying the Sherman–Morrison–Woodbury formula (A.28) to (6.17) to obtain $B_{k+1} = B_k - \\frac{B_k s_k s_k^T B_k}{s_k^T B_k s_k} + \\frac{y_k y_k^T}{y_k^T s_k}$.",
  "notes": "Internal: This is the BFGS update formula (6.19) for the Hessian approximation $B_k$. The variables $s_k = x_{k+1} - x_k$ and $y_k = \\nabla f_{k+1} - \\nabla f_k$ are defined in Algorithm 6.1 on the same page. The formula can be rewritten in the symmetric form: $B_{k+1} = (I - \\rho_k s_k y_k^T) B_k (I - \\rho_k y_k s_k^T) + \\rho_k s_k s_k^T$ where $\\rho_k = 1/(s_k^T y_k)$ (equation 6.14). Used in LbfgsTab to explain the BFGS/L-BFGS update mechanism.",
  "readerNotes": "The BFGS formula (6.19) updates the Hessian approximation $B_k$ using information from the most recent step. The notation: $s_k = x_{k+1} - x_k$ is the parameter change (step), $y_k = \\nabla f_{k+1} - \\nabla f_k$ is the gradient change, and $\\rho_k = 1/(s_k^T y_k)$ is the curvature scaling factor (equation 6.14). The secant equation $B_{k+1} s_k = y_k$ (equation 6.6, page 138) requires that the updated approximation maps the step to the gradient change, mimicking the property of the true Hessian. The formula maintains positive definiteness when the curvature condition $s_k^T y_k > 0$ holds (equation 6.7, page 138).",
  "proofPages": [
    "docs/references/extracted-pages/numericaloptimization2006_page_0160.png"
  ],
  "verified": "2025-11-13",
  "verifiedBy": "claude-sonnet-4-5",
  "verificationNotes": "CORRECTED (2025-11-13): Previous citation had CRITICAL ERRORS: (1) PAGE NUMBERS WRONG - listed pages 116-120 (PDF 136-140) which are Chapter 5 (Conjugate Gradient), but equation (6.19) is on page 140 (PDF 160) in Chapter 6 (Quasi-Newton). (2) COMPOSITE QUOTE - original quote included 'where s_k = x_{k+1} - x_k = \\alpha_k p_k and y_k = \\nabla f_{k+1} - \\nabla f_k' but this text does NOT appear after equation (6.19); these definitions appear in Algorithm 6.1 earlier on the same page. (3) CLAIM MISMATCH - original claim stated formula 'maintains positive definiteness and satisfies the secant equation' but the quote only gives the formula derivation, not proofs of those properties. CORRECTED: Quote is now verbatim from source. Claim now matches quote (formula derivation only). Formula extraction verified against PDF page 160 (book page 140). The extracted formula image confirms equation (6.19) exactly matches the quote. NOTE: Properties mentioned in readerNotes (secant equation 6.6, positive definiteness via curvature condition 6.7) need separate citations if we want to make claims about them. Updated proofPages to correct PDF page 160.",
  "usedIn": [
    "LbfgsTab"
  ],
  "pdfPages": "160",
  "formulaImages": [
    {
      "formula_id": "numericaloptimization2006_p160_bfgs_update_formula",
      "metadata_path": "docs/references/extracted-pages/formulas/numericaloptimization2006_p160_bfgs_update_formula.json",
      "image_path": "docs/references/extracted-pages/formulas/numericaloptimization2006_p160_bfgs_update_formula.png",
      "latex": "B_{k+1} = B_k - \\frac{B_k s_k s_k^T B_k}{s_k^T B_k s_k} + \\frac{y_k y_k^T}{y_k^T s_k}",
      "verified": true,
      "theorem": "BFGS update formula",
      "equation": "(6.19)"
    }
  ]
}
